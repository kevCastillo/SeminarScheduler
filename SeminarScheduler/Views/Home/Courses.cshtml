
@model SeminarScheduler.Views.Home.CoursesModel
@{
    ViewData["Title"] = "Courses";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="d-flex justify-content-between align-items-center">
                <h2>Seminar Courses</h2>
                <button class="btn btn-primary" data-toggle="modal" data-target="#addCourseModal">
                    <i class="fas fa-plus"></i> Add New Course
                </button>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h5 class="m-0">Course List</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="coursesTable" width="100%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>Course ID</th>
                                    <th>Course Name</th>
                                    <th>Department</th>
                                    <th>Faculty</th>
                                    <th>Schedule</th>
                                    <th>Room</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>CS101</td>
                                    <td>Introduction to Programming</td>
                                    <td>Computer Science</td>
                                    <td>Dr. Smith</td>
                                    <td>Mon/Wed 10:00-11:30</td>
                                    <td>Room 201</td>
                                    <td><span class="badge badge-success">Active</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                                        <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>MATH101</td>
                                    <td>Calculus Seminar</td>
                                    <td>Mathematics</td>
                                    <td>Dr. Johnson</td>
                                    <td>Tue/Thu 13:00-14:30</td>
                                    <td>Room 305</td>
                                    <td><span class="badge badge-success">Active</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                                        <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>ENG202</td>
                                    <td>Writing Workshop</td>
                                    <td>English</td>
                                    <td>Prof. Williams</td>
                                    <td>Fri 9:00-10:30</td>
                                    <td>Room 102</td>
                                    <td><span class="badge badge-warning">Conflict</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                                        <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>HIST101</td>
                                    <td>American History</td>
                                    <td>History</td>
                                    <td>Dr. Brown</td>
                                    <td>Fri 14:00-15:30</td>
                                    <td>Room 302</td>
                                    <td><span class="badge badge-success">Active</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                                        <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>PHYS101</td>
                                    <td>Physics Fundamentals</td>
                                    <td>Physics</td>
                                    <td>Dr. Davis</td>
                                    <td>Mon/Wed 14:00-15:30</td>
                                    <td>Room 405</td>
                                    <td><span class="badge badge-secondary">Draft</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                                        <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Edit Course Modal -->
<div class="modal fade" id="editCourseModal" tabindex="-1" role="dialog" aria-labelledby="editCourseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title" id="editCourseModalLabel">Edit Course</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editCourseForm">
                    <input type="hidden" id="editCourseIndex" />
                    <div class="form-row">
                        <div class="form-group col-md-4">
                            <label>Course ID</label>
                            <input type="text" class="form-control" id="editCourseId">
                        </div>
                        <div class="form-group col-md-8">
                            <label>Course Name</label>
                            <input type="text" class="form-control" id="editCourseName">
                        </div>
                    </div>
                    <!-- Add more fields as needed (department, faculty, etc.) -->
                    <div class="form-group">
                        <label>Status</label>
                        <select class="form-control" id="editCourseStatus">
                            <option>Draft</option>
                            <option>Active</option>
                            <option>Canceled</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-warning" id="saveEditBtn">Save Changes</button>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        $(document).ready(function () {
            $('#coursesTable').DataTable();

            // Edit button click
            $('#coursesTable').on('click', '.edit-btn', function () {
                var row = $(this).closest('tr');

                // Extract data from the row
                var courseId = row.find('td:eq(0)').text();
                var courseName = row.find('td:eq(1)').text();
                var status = row.find('td:eq(6)').text().trim();

                // Fill modal fields
                $('#editCourseId').val(courseId);
                $('#editCourseName').val(courseName);
                $('#editCourseStatus').val(status);

                // Store row index
                $('#editCourseIndex').val(row.index());

                // Show modal
                $('#editCourseModal').modal('show');
            });

            // Save edited course
            $('#saveEditBtn').click(function () {
                var index = $('#editCourseIndex').val();
                var row = $('#coursesTable tbody tr').eq(index);

                var newId = $('#editCourseId').val();
                var newName = $('#editCourseName').val();
                var newStatus = $('#editCourseStatus').val();

                // Update table data
                row.find('td:eq(0)').text(newId);
                row.find('td:eq(1)').text(newName);

                var badgeClass = newStatus === "Active" ? "badge-success" :
                                 newStatus === "Draft" ? "badge-secondary" : "badge-danger";

                row.find('td:eq(6)').html('<span class="badge ' + badgeClass + '">' + newStatus + '</span>');

                $('#editCourseModal').modal('hide');
            });
        });
    </script>
}
